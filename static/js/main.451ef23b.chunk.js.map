{"version":3,"sources":["constants.js","tools.js","component/Square.js","component/Board.js","component/Info.js","component/Game.js","index.js"],"names":["NUMBERCLASS","KEYCODE","GAMESTATE","randomTile","board","arr","i","length","push","r","Math","floor","random","n","toLeft","changeFlag","score","j","k","SIZE","Square","value","classNumber","className","Board","boardData","Array","fill","map","ele","idx","Info","handleStart","gameState","runtime","status","state","runtimeStr","scoreStr","repeat","title","onClick","Game","useState","setBoardData","setGameState","setRuntime","setScore","handleKeyboard","e","keyCode","preventDefault","tmp","change","scoreAdd","init","toRight","toUp","toDown","gameover","prev","useEffect","timer","setInterval","clearInterval","document","addEventListener","removeEventListener","tmp_board","href","target","rel","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.451ef23b.chunk.js","sourcesContent":["export const NUMBERCLASS={\r\n    0:\"\",\r\n    2:\"c2\",\r\n    4:\"c4\",\r\n    8:\"c8\",\r\n    16:\"c16\",\r\n    32:\"c32\",\r\n    64:\"c64\",\r\n    128:\"c128\",\r\n    256:\"c256\",\r\n    512:\"c512\",\r\n    1024:\"c1024\",\r\n    2048:\"c2048\"\r\n}\r\n\r\nexport const KEYCODE={\r\n    37:\"LEFT\",\r\n    38:\"UP\",\r\n    39:\"RIGHT\",\r\n    40:\"DOWN\"\r\n}\r\n\r\nexport const SIZE=4;\r\n\r\nexport const GAMESTATE = {\r\n\tREADY: 'ready',\r\n\tRUN: 'run',\r\n\tWIN: 'win',\r\n\tLOSE: 'lose'\r\n};","import { SIZE } from \"./constants\";\r\n\r\nexport function idx2Loc(idx){\r\n    let col=idx % SIZE;\r\n    let row=Math.floor(idx/SIZE);\r\n    return [row,col]\r\n}\r\n\r\nexport function randomTile(board){\r\n    let arr=[];\r\n    for(let i=0;i<board.length;i++){\r\n        if(board[i]===0) arr.push(i);\r\n    }\r\n    let r=Math.floor(Math.random()*arr.length);\r\n    let n=Math.floor(Math.random()*2)===1?4:2;\r\n    board[arr[r]]=n;\r\n}\r\n\r\nexport function toLeft(board){\r\n    let changeFlag=false;\r\n    let score=0;\r\n    for(let i=0;i<SIZE;i++){ //按行处理\r\n        //全部往左排\r\n        for(let j=0;j<SIZE;j++){\r\n            if(board[i*SIZE+j]===0){\r\n                for(let k=j+1;k<SIZE;k++){\r\n                    if(board[i*SIZE+k]!==0){\r\n                        [board[i*SIZE+j],board[i*SIZE+k]]=[board[i*SIZE+k],board[i*SIZE+j]];\r\n                        changeFlag=true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        //合并\r\n        let k=1;\r\n        while(k<SIZE&&board[i*SIZE+k]!==0){\r\n            if(board[i*SIZE+k]===board[i*SIZE+k-1]){\r\n                board[i*SIZE+k-1]=2*board[i*SIZE+k-1];\r\n                for(let j=k;j<SIZE;j++){\r\n                    board[i*SIZE+j]=j===SIZE-1?0:board[i*SIZE+j+1];\r\n                }\r\n                // board[i*SIZE+k]=k===SIZE-1?0:board[i*SIZE+k+1];\r\n                changeFlag=true;\r\n                score+=board[i*SIZE+k-1];\r\n            }\r\n            k++;\r\n        }\r\n\r\n    }\r\n    return [changeFlag,score];\r\n}\r\n\r\nexport function toRight(board){\r\n    let init=[...board];\r\n    for(let i=0;i<SIZE;i++){\r\n        for(let j=0;j<Math.floor(SIZE/2);j++){\r\n            [init[SIZE*i+j],init[SIZE*i+SIZE-j-1]]=[init[SIZE*i+SIZE-j-1],init[SIZE*i+j]]\r\n        }\r\n    }\r\n    let change=toLeft(init);\r\n    for(let i=0;i<SIZE;i++){\r\n        for(let j=0;j<SIZE;j++){\r\n            board[SIZE*i+j]=init[SIZE*i+SIZE-j-1];\r\n        }\r\n    }\r\n    return change;\r\n}\r\n\r\nexport function toUp(board){\r\n    let init=[];\r\n    for(let i=0;i<SIZE;i++){\r\n        for(let j=0;j<SIZE;j++){\r\n            init[SIZE*i+j]=board[SIZE*j+SIZE-i-1];\r\n        }\r\n    }\r\n    let change=toLeft(init);\r\n    for(let i=0;i<SIZE;i++){\r\n        for(let j=0;j<SIZE;j++){\r\n            board[SIZE*i+j]=init[SIZE*(SIZE-j-1)+i];\r\n        }\r\n    }\r\n    return change;\r\n}\r\n\r\nexport function toDown(board){\r\n    let init=[];\r\n    for(let i=0;i<SIZE;i++){\r\n        for(let j=0;j<SIZE;j++){\r\n            init[SIZE*i+j]=board[SIZE*(SIZE-j-1)+i];\r\n        }\r\n    }\r\n    let change=toLeft(init);\r\n    for(let i=0;i<SIZE;i++){\r\n        for(let j=0;j<SIZE;j++){\r\n            board[SIZE*i+j]=init[SIZE*j+SIZE-i-1];\r\n        }\r\n    }\r\n    return change;\r\n}\r\n\r\nexport function gameover(board){\r\n    for(let i=0;i<SIZE;i++){\r\n        for(let j=0;j<SIZE;j++){\r\n            if(board[i*SIZE+j]===0) return false;\r\n            if(i>0&&board[i*SIZE+j]===board[(i-1)*SIZE+j]) return false;\r\n            if(j>0&&board[i*SIZE+j]===board[i*SIZE+j-1]) return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n","import { NUMBERCLASS } from \"../constants\";\r\n\r\nfunction Square({value}){\r\n    const classNumber=NUMBERCLASS[value];\r\n    return (\r\n        <div className={`square ${classNumber}`}>{value!==0?value:\"\"}</div>\r\n    )\r\n}\r\n\r\nexport default Square;","import Square from \"./Square\";\r\n\r\nfunction Board({boardData}){\r\n    \r\n    return (\r\n        <div className=\"board\">\r\n            {Array(16).fill(null).map((ele,idx)=>(\r\n                <Square value={boardData[idx]} key={idx} />\r\n            ))}    \r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Board;","import { GAMESTATE } from \"../constants\";\r\n\r\nfunction Info({handleStart,gameState,runtime,score}){\r\n    const status=((state)=>{\r\n        switch(state){\r\n            case GAMESTATE.RUN: return \"😀\";\r\n            case GAMESTATE.LOSE:return \"😢\";\r\n            default:return \"🙂\";\r\n        }\r\n    })(gameState);\r\n\r\n    let runtimeStr=\"\"+runtime,scoreStr=\"\"+score;\r\n    if(runtimeStr.length<4) runtimeStr=\"0\".repeat(4-runtimeStr.length)+runtimeStr;\r\n    if(scoreStr.length<4) scoreStr=\"0\".repeat(4-scoreStr.length)+scoreStr;\r\n\r\n    return (\r\n        <div className=\"info\">\r\n            <div className=\"score\"><span>🎰</span>{scoreStr}</div>\r\n            <div className=\"status\" title=\"重开\"><button onClick={handleStart}>{status}</button></div>\r\n            <div className=\"time\"><span>🕙</span>{runtimeStr}</div>\r\n        </div>\r\n    )\r\n\r\n}\r\nexport default Info;","import { useEffect, useState } from \"react\";\r\nimport { GAMESTATE, KEYCODE } from \"../constants\";\r\nimport { gameover, randomTile, toDown, toLeft, toRight, toUp } from \"../tools\";\r\nimport Board from \"./Board\";\r\nimport Info from \"./Info\";\r\nfunction Game(){\r\n    const [boardData,setBoardData]=useState(new Array(16).fill(0));\r\n    const [gameState,setGameState]=useState(GAMESTATE.READY);\r\n    const [runtime,setRuntime]=useState(0);\r\n    const [score,setScore]=useState(0);\r\n\r\n    const reducer=(state,action)=>{\r\n        switch(action.type){\r\n\r\n        }\r\n    }\r\n\r\n    const handleStart=()=>{\r\n        let tmp_board=new Array(16).fill(0);\r\n        randomTile(tmp_board);\r\n        setBoardData(tmp_board);\r\n        setGameState(GAMESTATE.RUN);\r\n        setRuntime(0);\r\n        setScore(0);\r\n    }\r\n\r\n    const handleKeyboard=(e)=>{\r\n        if(KEYCODE[e.keyCode]){\r\n            e.preventDefault();\r\n            let tmp=[...boardData],change=false,scoreAdd=0;\r\n            switch(KEYCODE[e.keyCode]){\r\n                case \"LEFT\": [change,scoreAdd]=toLeft(tmp);break;\r\n                case \"RIGHT\": [change,scoreAdd]=toRight(tmp);break;\r\n                case \"UP\": [change,scoreAdd]=toUp(tmp);break;\r\n                case \"DOWN\": [change,scoreAdd]=toDown(tmp);break;\r\n                default:break;\r\n            }\r\n\r\n           if(change){\r\n                randomTile(tmp);\r\n                if(gameover(tmp)) setGameState(GAMESTATE.LOSE);\r\n           }\r\n\r\n           setBoardData(tmp);\r\n           setScore(prev=>prev+scoreAdd);\r\n        }\r\n    }\r\n\r\n    useEffect(()=>{\r\n        let timer=null\r\n        if(gameState===GAMESTATE.RUN){\r\n            timer=setInterval(()=>{\r\n                setRuntime(prev=>prev+1);\r\n            },1000);\r\n        }else if(timer){\r\n            clearInterval(timer);\r\n            timer=null;\r\n        }\r\n\r\n        return ()=>{\r\n            if(timer) clearInterval(timer);\r\n        }\r\n    },[gameState]);\r\n\r\n    useEffect(()=>{\r\n        document.addEventListener(\"keyup\",handleKeyboard);\r\n\r\n        return ()=>{\r\n            document.removeEventListener(\"keyup\",handleKeyboard);\r\n        }\r\n    })\r\n\r\n    return (\r\n        <div className=\"box\">\r\n            <main>\r\n                <h1>2048 Game in React</h1>\r\n                <Info handleStart={handleStart} gameState={gameState} runtime={runtime} score={score}/>\r\n                <Board boardData={boardData}/>\r\n            </main>\r\n            <div className=\"ref\">\r\n                <p>Source Code Link: <a href=\"https://github.com/kokoyo1997/2048-react\" target=\"_blank\" rel=\"noreferrer\">https://github.com/kokoyo1997/2048-react</a></p>\r\n            </div>\r\n        </div> \r\n    )\r\n}\r\n\r\nexport default Game;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport Game from './component/Game';\n\nReactDOM.render(\n    <Game />,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}